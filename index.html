<!DOCTYPE html>
<html lang="pt-br">
<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
  <title>Controle de Estoque</title>
  <style>
    body {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
      text-align: center;
    }

    input{
      text-align: center;
      width: 30%;
    }
  
    /* Buttons */
    .tab-button {
      width: fit-content;
      box-shadow: 0px 2px 8px rgba(0, 0, 0, 0.7);
      font-size: 20px;
      padding: 5px 10px;
      margin-right: 5px;
      border-radius: 10px;
      background-color: darkgray;
      border: 1px solid black;
    }
  
    .tab-button:focus {
      outline: none;
    }
  
    .BTN {
      width: fit-content;
      font-size: 20px;
      padding: 10px;
    }
  
    button {
      width: fit-content;
      border-radius: 10px;
      font-size: 80%;
      padding: 8px;
    }
  
    /* Tables */
    table,
    th,
    td {
      font-size: 1rem;
      text-align: center;
      background-color: darkgray;
      margin: 0 auto;
      border: 1px solid black;
      border-collapse: collapse;
      border-radius: 10px;
      padding: 5px;
    }
  
    /* Headings */
    h1 {
      font-size: 40px;
    }
  
    h2 {
      font-size: 30px;
    }
  
    /* Excluir button */
    #excluir {
      width: fit-content;
      padding: 8px;
    }
  
    /* Tabs */
    .tabs {
      display: flex;
      justify-content: center;
      margin-bottom: 10px;
    }
  
    /* Content */
    #estoque-content,
    #retirada-content {
      display: none;
    }

        #copiarButton {
      margin-top: 10px;
      padding: 10px;
    }

    #copiadoDiv {
      margin-top: 20px;
      padding: 10px;
      border: 1px solid black;
      border-radius: 10px;
      background-color: lightgray;
    }
    
    #habilitar input{
      width: fit-content;
    }
    
    select{
      width: 100%;
      text-align: center;
    }


  </style>
  
</head>
<body>
  <h1>CONTROLE DE ESTOQUE</h1>
  <button class="BTN" onclick="mostrarRetirada()">Retirada do Estoque</button>
  <button class="BTN" onclick="mostrarEstoque()">Estoque Atual</button>
  <div id="estoqueDiv" style="display: none;">
  
  <table id="estoque">
    <h2>Estoque Atual</h2>
    <tr>
      <th>Quantidade</th>
      <th>Ações</th>
    </tr>
  </table>
  <br>
  <button class="BTN" onclick="adicionar()">Adicionar Produto</button>
  </div>

  <br><br>


<table style="display: block" id="habilitar">
<tr>
  <th>Técnico:</th>
  <td>
    <select id="tecnico">
      <option value="Andre">André Levi</option>
      <option value="Elvis">Elvis</option>
      <option value="Guilherme" selected>Guilherme</option>
      <option value="Robson">Robson</option>
      <option value="Sergio">Sérgio</option>
    </select>
  </td>
</tr>

  <tr>
    <th>Cliente:</th>
    <td><input type="text" id="cliente"></td>
  </tr>
  <tr>
    <th>Fibra metragem:</th>
    <td><input type="number" min="" value="" id="fibraMetragem"></td>
  </tr>
  <tr>
    <th>CTO:</th>
    <td><input type="number" value="" id="cto"></td>
  </tr>
  <tr>
    <th>Porta:</th>
    <td><input type="number" value="" id="porta"></td>
  </tr>
  <tr>
    <th>Sinal CTO:</th>
    <td><input type="number" value="" id="sinalCto"></td>
  </tr>
  <tr>
    <th>Sinal Cliente:</th>
    <td><input type="number" value="" id="sinalCliente"></td>
  </tr>
  <tr>
    <th>SC-APC:</th>
    <td><input type="number" value="" id="scApc"></td>
  </tr>
  <tr>
    <th>SC-UPC:</th>
    <td><input type="number" value="" id="scUpc"></td>
  </tr>
  <tr>
    <th>Esticadores:</th>
    <td><input type="number" value="" id="esticadores"></td>
  </tr>
  <tr>
    <th>Roldana:</th>
    <td><input type="number" value="" id="roldana"></td>
  </tr>
  <tr>
    <th>Fecho:</th>
    <td><input type="number" value="" id="fecho"></td>
  </tr>
  <tr>
    <th>Anel:</th>
    <td><input type="number" value="" id="anel"></td>
  </tr>
  <tr>
    <th>Fita aço:</th>
    <td><input type="number" value="" id="fitaAco"></td>
  </tr>
  <tr>
    <th>Fixa fio:</th>
    <td><input type="number" value="" id="fixaFio"></td>
  </tr>
  <tr>
    <th>Isolante:</th>
    <td><input type="number" value="" id="isolante"></td>
  </tr>
  <tr>
    <th>Cabo de rede:</th>
    <td><input type="number" value="" id="caboRede"></td>
  </tr>
  <tr>
    <th>Conc RJ45:</th>
    <td><input type="number" value="" id="concRj45"></td>
  </tr>
  <tr>
    <th>Kit fusão:</th>
    <td><input type="number" value="" id="kitFusao"></td>
  </tr>
  <tr>
</table>


  
  
  
  <div id="retiradaDiv" style="display: block;">
  <table id="retirada">
    <h2>Retirada de Estoque</h2>
    <tr>
      <th>Produto</th>
      <th>Quantidade</th>
      <th>Ações</th>
    </tr>
  </table>
  <br>
  <button class="BTN" onclick="enviar()">Enviar</button>
  <input type="text" id="clipboardInput" style="position: absolute; left: -9999px;">

  </div>

  <script>


//funcao para apagar o valor de quando o imput é selecionado
   function clearValue(inputId) {
      document.getElementById(inputId).value = "";
    }


    // Função para exibir a seção do estoque e ocultar a seção de retirada
    function mostrarEstoque() {
      document.getElementById("estoqueDiv").style.display = "block";
      document.getElementById("retiradaDiv").style.display = "none";
      
      document.getElementById("habilitar").style.display = "block";
      document.getElementById("habilitar").style.display = "none";
    }

    // Função para exibir a seção de retirada e ocultar a seção do estoque
    function mostrarRetirada() {
      document.getElementById("estoqueDiv").style.display = "none";
      document.getElementById("retiradaDiv").style.display = "block";
      
      document.getElementById("habilitar").style.display = "none";
      document.getElementById("habilitar").style.display = "block";
      
    }
    
    

    // Variáveis para armazenar os produtos e retiradas, utilizando o armazenamento local (localStorage)
    let produtos = JSON.parse(localStorage.getItem("produtos")) || [
      { nome: "ONU", quantidade: 10 },
      { nome: "AX2H", quantidade: 6 },
      { nome: "AX2V", quantidade: 2 },
      { nome: "APC", quantidade: 10 },
      { nome: "UPC", quantidade: 4 },
      { nome: "RJ45", quantidade: 10 },
      { nome: "WS5200", quantidade: 3 },
      { nome: "Q2", quantidade: 1 },
      { nome: "TPlink", quantidade: 5 },
      { nome: "46M", quantidade: 2 },
      { nome: "V5", quantidade: 1 },
      { nome: "TVBOX", quantidade: 1 },
      { nome: "DROP", quantidade: 1000 }
      ,
    ];



    let retirada = JSON.parse(localStorage.getItem("retirada")) || [];


    // Função para atualizar a tabela de estoque com os produtos e suas quantidades
    function atualizarTabelaEstoque() {
      let tabela = document.getElementById("estoque");
      tabela.innerHTML = "<tr><th>Produto</th><th>Quantidade</th><th>Ações</th></tr>";
      for (let i = 0; i < produtos.length; i++) {
        let linha = tabela.insertRow(-1);
        let celulaNome = linha.insertCell(0);
        let celulaQuantidade = linha.insertCell(1);
        let celulaAcoes = linha.insertCell(2);
        celulaNome.innerHTML = produtos[i].nome;
        celulaQuantidade.innerHTML = `<input type="number" min="0" value="${produtos[i].quantidade}" onchange="atualizarQuantidadeEstoque(${i}, this.value)">`;
        celulaAcoes.innerHTML = `<button onclick="aumentarEstoque(${i})">+</button> <button onclick="diminuirEstoque(${i})">-</button> <button id="excluir" onclick="excluir(${i})">Excluir</button>`;
      }
    }
    

    // Função para atualizar a tabela de retirada com os produtos e suas quantidades
    function atualizarTabelaRetirada() {
      let tabela = document.getElementById("retirada");
      tabela.innerHTML = "<tr><th>Produto</th><th>Quantidade</th><th>Ações</th></tr>";
      for (let i = 0; i < retirada.length; i++) {
        let linha = tabela.insertRow(-1);
        let celulaNome = linha.insertCell(0);
        let celulaQuantidade = linha.insertCell(1);
        let celulaAcoes = linha.insertCell(2);
        celulaNome.innerHTML = retirada[i].nome;
        celulaQuantidade.innerHTML = `<input type="number" min="0" value="${retirada[i].quantidade}" onchange="atualizarQuantidadeRetirada(${i}, this.value)">`;
        celulaAcoes.innerHTML = `<button onclick="aumentarRetirada(${i})">+</button> <button onclick="diminuirRetirada(${i})">-</button>`;
      }
    }

    // Função para aumentar a quantidade de um produto no estoque
    function aumentarEstoque(indice) {
      produtos[indice].quantidade++;
      atualizarTabelaEstoque();
      salvarDados();
    }

    // Função para diminuir a quantidade de um produto no estoque
    function diminuirEstoque(indice) {
      if (produtos[indice].quantidade > 0) {
        produtos[indice].quantidade--;
        atualizarTabelaEstoque();
        salvarDados();
      }
    }

    // Função para aumentar a quantidade de um produto na retirada
    function aumentarRetirada(indice) {
      retirada[indice].quantidade++;
      atualizarTabelaRetirada();
      salvarDados();
    }

    
    // Função para diminuir a quantidade de um produto na retirada
    function diminuirRetirada(indice) {
      if (retirada[indice].quantidade > 0) {
        retirada[indice].quantidade--;
        atualizarTabelaRetirada();
        salvarDados();
      }
    }

    // Função para adicionar um novo produto ao estoque e à retirada
    function adicionar() {
      let nome = prompt("Nome do produto:");
      if (nome) {
        produtos.push({ nome, quantidade: 0 });
        retirada.push({ nome, quantidade: 0 });
        atualizarTabelaEstoque();
        atualizarTabelaRetirada();
        salvarDados();
      }
    }

    // Função para excluir um produto do estoque e da retirada
    function excluir(indice) {
      let nome = produtos[indice].nome;
      produtos.splice(indice, 1);
      for (let i = 0; i < retirada.length; i++) {
        if (retirada[i].nome === nome) {
          retirada.splice(i, 1);
          break;
        }
      }
      atualizarTabelaEstoque();
      atualizarTabelaRetirada();
      salvarDados();
    }

        // Função para processar a retirada de produtos
      function enviar() {
        for (let i = 0; i < retirada.length; i++) {
          let produtoRetirado = retirada[i];
          for (let j = 0; j < produtos.length; j++) {
            if (produtos[j].nome === produtoRetirado.nome) {
              produtos[j].quantidade -= produtoRetirado.quantidade;
              break;
            }
          }
          produtoRetirado.quantidade = 0;
        }
        
        
        
        
        
        
        
        
        
        
        
        

        atualizarTabelaEstoque();
        atualizarTabelaRetirada();
        salvarDados();

        // Chamar a função para copiar o conteúdo após o envio
        setTimeout(copiarConteudo, 200)}

// Função para copiar o conteúdo atualizado para a área de transferência
function copiarConteudo() {
  let copiado = '*Meu estoque:*#____________#';

  // Construir a string com a estrutura desejada, substituindo as quebras de linha pelo caractere "#"
  for (let i = 0; i < produtos.length; i++) {
    copiado += `${produtos[i].nome}:${produtos[i].quantidade}#`;
  }
  
  
  //estrututa da 1• tabela 
  copiado += `#*Favor Habilitar*##Técnico: ${document.getElementById('tecnico').value}\n`;
copiado += `Cliente: ${document.getElementById('cliente').value}\n`;
copiado += `Fibra Metragem: ${document.getElementById('fibraMetragem').value}\n`;
copiado += `CTO: ${document.getElementById('cto').value}\n`;
copiado += `Porta: ${document.getElementById('porta').value}\n`;
copiado += `Sinal CTO: ${document.getElementById('sinalCto').value}\n`;
copiado += `Sinal Cliente: ${document.getElementById('sinalCliente').value}\n`;
copiado += `SC-APC: ${document.getElementById('scApc').value}\n`;
copiado += `SC-UPC: ${document.getElementById('scUpc').value}\n`;
copiado += `Esticadores: ${document.getElementById('esticadores').value}\n`;
copiado += `Roldana: ${document.getElementById('roldana').value}\n`;
copiado += `Fecho: ${document.getElementById('fecho').value}\n`;
copiado += `Anel: ${document.getElementById('anel').value}\n`;
copiado += `Fita aço: ${document.getElementById('fitaAco').value}\n`;
copiado += `Fixa fio: ${document.getElementById('fixaFio').value}\n`;
copiado += `Isolante: ${document.getElementById('isolante').value}\n`;
copiado += `Cabo de rede: ${document.getElementById('caboRede').value}\n`;
copiado += `Conc RJ45: ${document.getElementById('concRj45').value}\n`;
copiado += `Kit fusão: ${document.getElementById('kitFusao').value}##*Obrigado !!*\n`;




  // Substituir o "#" por quebras de linha (\n)
  copiado = copiado.replace(/#/g, '\n');

  // Exiba o conteúdo da variável 'copiado' no console
  console.log('Conteúdo Atualizado:', copiado);
  


  // Crie um elemento de input temporário
  const tempInput = document.createElement('textarea');
  tempInput.style.position = 'absolute';
  tempInput.style.left = '-9999px';
  tempInput.value = copiado;

  // Anexe o elemento de input ao corpo do documento
  document.body.appendChild(tempInput);

  // Selecione o texto no elemento de input
  tempInput.select();

  // Copie o texto para a área de transferência
  document.execCommand('copy');

  // Remova o elemento de input temporário
  document.body.removeChild(tempInput);
    alert(copiado)
}







    function atualizarQuantidadeEstoque(indice, quantidade) {
      produtos[indice].quantidade = parseInt(quantidade);
      salvarDados();
    }

    function atualizarQuantidadeRetirada(indice, quantidade) {
      retirada[indice].quantidade = parseInt(quantidade);
      salvarDados();
    }

    function salvarDados() {
      localStorage.setItem("produtos", JSON.stringify(produtos));
      localStorage.setItem("retirada", JSON.stringify(retirada));
    }

    // Inicializa a tabela de retirada com os mesmos produtos da tabela de estoque
    if (retirada.length === 0) {
      for (let i = 0; i < produtos.length; i++) {
        retirada.push({ nome: produtos[i].nome, quantidade: 0 });
      }
    }

    atualizarTabelaEstoque();
    atualizarTabelaRetirada();
  </script>
</body>
</html>
